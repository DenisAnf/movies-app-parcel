const e=/[ \t\r\n\p{P}\s]/gu,t=document.querySelector("#filmName"),n=document.querySelector("#filmAddButton"),u=document.querySelector("#filmError"),c=document.querySelector("#movies"),i=function(e){//! ИСПРАВИТЬ СЛУШАТЕЛИ
let t=document.querySelector(e);return{outputNode:t,render:function(e){this.outputNode.innerHTML="";let t=document.createElement("ul");t.className="movies__list",e.forEach((e,n)=>{let u=document.createElement("li"),c=document.createElement("label"),i=document.createElement("input"),l=document.createElement("div"),o=document.createElement("span"),s=document.createElement("button");u.className="movies__list-item",c.className="movie",i.className="movie__checkbox",l.className="movie__fakecheckbox",o.className="movie__title",s.className="movie__deleteBtn",u.setAttribute("id",n),i.setAttribute("type","checkbox"),i.setAttribute(e.check,""),s.setAttribute("id",n),o.innerText=e.name,u.appendChild(c),c.appendChild(i),c.appendChild(l),c.appendChild(o),c.appendChild(s),t.appendChild(u),s.addEventListener("click",()=>{//films.splice(index, 1);
//saveFilmsToLocalStorage();
//renderFilms();
})}),this.outputNode.appendChild(t)},check:function(e){"unchecked"===e.check?e.check="checked":e.check="unchecked"}}}("#movies"),l={movies:[],update:function(e){this.movies=e},create:function(e){return{name:e,check:"unchecked"}},add:function(e){this.movies.push(e)},get:function(){return this.movies},clear:function(){this.movies=[]},deleteElement:function(e){this.movies.splice(e,1)}},o={key:"movies",read:function(){let e=localStorage.getItem(this.key);if(!e)return null;let t=JSON.parse(e);return Array.isArray(t)?t:null},push:function(e){let t=JSON.stringify(e);localStorage.setItem(this.key,t)}};(()=>{let e=o.read();e&&l.update(e),i.render(l.get()),t.focus()})();const s=()=>{let n=t.value,c=n.length,i=n.replace(e,""),l=i.length;return n&&0!=l?c>130?(u.textContent=`\u{41D}\u{435} \u{431}\u{44B}\u{432}\u{430}\u{435}\u{442} \u{444}\u{438}\u{43B}\u{44C}\u{43C}\u{43E}\u{432} \u{434}\u{43B}\u{438}\u{43D}\u{435}\u{435} 130 \u{441}\u{438}\u{43C}\u{432}\u{43E}\u{43B}\u{43E}\u{432} (${c}/130)`,t.focus(),!0):(u.textContent="",!1):(u.textContent="Введите правильно название фильма",t.focus(),!0)},r=()=>{if(s())return;let e=l.create(t.value);l.add(e),i.render(l.get()),o.push(l.get()),t.value=""};n.addEventListener("click",r),t.addEventListener("keydown",e=>{13===e.keyCode&&(e.preventDefault(),r(),t.focus())}),c.addEventListener("click",e=>{let t;e.preventDefault(),e.target.classList.contains("movies__list-item")?t=e.target.id:e.target.closest(".movies__list-item")&&(t=e.target.closest(".movies__list-item").id),i.check(l.get()[t]),i.render(l.get()),o.push(l.get())}),c.addEventListener("click",e=>{if(e.target.classList.contains("movie__deleteBtn")){let t=e.target.id;console.log(t),l.deleteElement(t),i.render(l.get()),o.push(l.get())}});